<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mason Portal</title>
  <style>
    body{margin:0;font-family:Tahoma,Arial,sans-serif;background:#f2f2f2;color:#111}
    .bar{background:#e5e5e5;border-bottom:1px solid #c8c8c8;padding:10px 16px;font-weight:700}
    .wrap{width:100%;max-width:1400px;margin:0 auto;padding:12px 16px 24px}
    .panel{background:#fff;border:1px solid #c8c8c8;padding:12px}
    h1{font-size:20px;margin:0 0 6px}
    h2{font-size:16px;margin:0 0 8px}
    p{margin:0 0 8px}
    label{display:block;font-size:12px;margin:8px 0 4px;color:#333}
    input,textarea{width:100%;padding:6px;border:1px solid #999;font-family:Tahoma,Arial,sans-serif;font-size:12px}
    textarea{min-height:80px}
    button{padding:6px 10px;border:1px solid #777;background:#efefef;cursor:pointer;font-size:12px}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    .grid-2 .panel{height:100%}
    .list{border:1px solid #ddd;background:#fafafa;padding:8px;margin-top:8px;max-height:360px;overflow:auto}
    .item{border-bottom:1px solid #ddd;padding:6px 0}
    .item:last-child{border-bottom:0}
    .muted{color:#666;font-size:12px}
    .danger{color:#b00020;border-color:#b00020}
    .hidden{display:none}
    .pill{display:inline-block;background:#f0f0f0;border:1px solid #ccc;padding:2px 6px;font-size:11px}
    .section-title{background:#f0f0f0;border:1px solid #c8c8c8;padding:6px 8px;font-weight:700;margin:0 0 8px}
    .split{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:980px){
      .grid-2,.split{grid-template-columns:1fr}
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.6.1/frappe-gantt.css">
</head>
<body>
  <div class="bar">Mason Portal â€” Internal</div>
  <div class="wrap">
    <section class="panel" id="pinGate">
      <h1>Login</h1>
      <p class="muted">PIN required.</p>
      <div class="row">
        <input id="pinInput" type="password" inputmode="numeric" placeholder="PIN" style="max-width:180px" />
        <button id="pinBtn">Unlock</button>
        <span id="pinStatus" class="muted"></span>
      </div>
    </section>

    <section class="panel hidden" id="portal">
      <h1>Portal</h1>
      <p class="muted">Manage announcements, conversations, reviews, and sessions.</p>

      <div class="panel" style="margin-top:12px">
        <div class="section-title">Business Stats</div>
        <div id="stats" class="list"></div>
      </div>

      <div class="grid-2">
        <div class="panel">
          <div class="section-title">Announcements</div>
          <form id="announceForm">
            <label for="announceText">Message</label>
            <textarea id="announceText" required></textarea>
            <div class="row" style="margin-top:6px">
              <button type="submit">Send</button>
              <span id="announceStatus" class="muted"></span>
            </div>
          </form>
          <div id="announcements" class="list"></div>
        </div>

        <div class="panel">
          <div class="section-title">Book Session</div>
          <form id="sessionForm">
            <label for="sessionName">Name</label>
            <input id="sessionName" required />
            <label for="sessionContact">Contact</label>
            <input id="sessionContact" required />
            <label for="sessionDetails">Details</label>
            <textarea id="sessionDetails"></textarea>
            <label for="sessionWhen">When (ISO or plain text)</label>
            <input id="sessionWhen" placeholder="2026-02-01 18:00" />
            <div class="row" style="margin-top:6px">
              <button type="submit">Create</button>
              <span id="sessionStatus" class="muted"></span>
            </div>
          </form>
        </div>
      </div>

      <div class="split" style="margin-top:12px">
        <div class="panel">
          <div class="section-title">Conversations</div>
          <div id="conversations" class="list"></div>
          <div id="conversationView" class="list hidden"></div>
          <form id="replyForm" class="hidden" style="margin-top:8px">
            <label for="replyText">Reply</label>
            <textarea id="replyText" required></textarea>
            <div class="row" style="margin-top:6px">
              <button type="submit">Send reply</button>
              <span id="replyStatus" class="muted"></span>
            </div>
          </form>
        </div>

        <div class="panel">
          <div class="section-title">Reviews</div>
          <div id="reviews" class="list"></div>
        </div>
      </div>
      </div>

      <div class="panel" style="margin-top:12px">
        <div class="section-title">Sessions Gantt</div>
        <div id="gantt" class="list" style="height:320px;overflow:auto"></div>
      </div>

    </section>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.6.1/frappe-gantt.min.js"></script>
  <script src="masonportal.js"></script>
</body>
</html>
